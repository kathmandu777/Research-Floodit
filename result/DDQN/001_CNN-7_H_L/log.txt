
(RL-gpu) C:\Users\kator\OneDrive\ドキュメント\ResearchFloodit\excute file>python floodit-learning.py
2021-03-01 13:35:52.412010: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudart64_101.dll
pygame 2.0.1 (SDL 2.0.14, Python 3.7.9)
Hello from the pygame community. https://www.pygame.org/contribute.html



**************************************************  FloodIt  **************************************************
action_space      : Discrete(6)
observation_space : Box(0.0, 5.0, (30, 30), float32)
reward_range      : (-inf, inf)




**************************************************  Model  **************************************************

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
reshape (Reshape)            (None, 30, 30, 1)         0
_________________________________________________________________
conv2d (Conv2D)              (None, 28, 28, 32)        320
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 26, 26, 32)        9248
_________________________________________________________________
flatten (Flatten)            (None, 21632)             0
_________________________________________________________________
dense (Dense)                (None, 128)               2769024
_________________________________________________________________
dense_1 (Dense)              (None, 64)                8256
_________________________________________________________________
dense_2 (Dense)              (None, 64)                4160
_________________________________________________________________
dense_3 (Dense)              (None, 6)                 390
=================================================================
Total params: 2,791,398
Trainable params: 2,791,398
Non-trainable params: 0
_________________________________________________________________
None
2021-03-01 13:35:57.133160: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library nvcuda.dll
2021-03-01 13:35:57.172292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce GTX 1650 computeCapability: 7.5
coreClock: 1.56GHz coreCount: 16 deviceMemorySize: 4.00GiB deviceMemoryBandwidth: 119.24GiB/s
2021-03-01 13:35:57.180254: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudart64_101.dll
2021-03-01 13:35:57.588960: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cublas64_10.dll
2021-03-01 13:35:57.934048: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cufft64_10.dll
2021-03-01 13:35:57.965800: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library curand64_10.dll
2021-03-01 13:35:58.205962: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cusolver64_10.dll
2021-03-01 13:35:58.405112: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cusparse64_10.dll
2021-03-01 13:35:58.625081: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudnn64_7.dll
2021-03-01 13:35:58.629524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-03-01 13:35:58.632696: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-01 13:35:58.653643: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a5aba3a120 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-01 13:35:58.658891: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-01 13:35:58.666604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce GTX 1650 computeCapability: 7.5
coreClock: 1.56GHz coreCount: 16 deviceMemorySize: 4.00GiB deviceMemoryBandwidth: 119.24GiB/s
2021-03-01 13:35:58.676421: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudart64_101.dll
2021-03-01 13:35:58.682222: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cublas64_10.dll
2021-03-01 13:35:58.686173: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cufft64_10.dll
2021-03-01 13:35:58.691635: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library curand64_10.dll
2021-03-01 13:35:58.695647: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cusolver64_10.dll
2021-03-01 13:35:58.700213: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cusparse64_10.dll
2021-03-01 13:35:58.704214: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudnn64_7.dll
2021-03-01 13:35:58.710355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-03-01 13:35:59.333701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-01 13:35:59.337700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0
2021-03-01 13:35:59.340400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N
2021-03-01 13:35:59.344393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2905 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1650, pci bus id: 0000:01:00.0, compute capability: 7.5)
2021-03-01 13:35:59.355193: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1a5d446eea0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-03-01 13:35:59.360409: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1650, Compute Capability 7.5



**************************************************  History  **************************************************

Training for 1000000 steps ...
Interval 1 (0 steps performed)
WARNING:tensorflow:From D:\Anaconda\envs\RL-gpu\lib\site-packages\tensorflow\python\keras\engine\training_v1.py:2070: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-03-01 13:35:59.887101: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cublas64_10.dll
2021-03-01 13:36:00.186563: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudnn64_7.dll
2021-03-01 13:36:01.441282: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: Invoking GPU asm compilation is supported on Cuda non-Windows platforms only
Relying on driver to perform ptx compilation.
Modify $PATH to customize ptxas location.
This message will be only logged once.
10000/10000 [==============================] - 317s 32ms/step - reward: -0.3472
7106 episodes - episode_reward: -0.489 [-0.500, -0.143] - loss: 0.005 - mae: 0.399 - mean_q: -0.414 - isWon: 0.000 - isLose: 0.000 - changed_square: 0.517 - life: 62.652

Interval 2 (10000 steps performed)
 4592/10000 [============>.................] - ETA: 3:04 - reward: -0.3468done, took 473.287 seconds



**************************************************  Test  **************************************************

Testing for 10 episodes ...
libpng warning: iCCP: known incorrect sRGB profile
libpng warning: iCCP: known incorrect sRGB profile
libpng warning: iCCP: known incorrect sRGB profile
libpng warning: iCCP: known incorrect sRGB profile
libpng warning: iCCP: known incorrect sRGB profile
Episode 1: reward: -0.435, steps: 2
Episode 2: reward: -0.485, steps: 2
Episode 3: reward: -0.500, steps: 1
Episode 4: reward: -0.452, steps: 2
Episode 5: reward: -0.485, steps: 2
Episode 6: reward: -0.485, steps: 2
Episode 7: reward: -0.485, steps: 2
Episode 8: reward: -0.468, steps: 2
Episode 9: reward: -0.500, steps: 1
Episode 10: reward: -0.500, steps: 1

(RL-gpu) C:\Users\kator\OneDrive\ドキュメント\ResearchFloodit\excute file>